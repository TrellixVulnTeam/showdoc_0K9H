{"remainingRequest":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/item/setting/Member.vue?vue&type=style&index=0&id=5256464c&scoped=true&lang=css&","dependencies":[{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/item/setting/Member.vue","mtime":1623401622642},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmhlbGxvIHsKICB0ZXh0LWFsaWduOiBsZWZ0Owp9Ci5hZGQtbWVtYmVyIHsKICBtYXJnaW4tbGVmdDogMTBweDsKfQoudGlwcyB7CiAgZm9udC1zaXplOiAxMnB4OwogIG1hcmdpbi1ib3R0b206IDBweDsKICBtYXJnaW4tdG9wOiAwcHg7Cn0K"},{"version":3,"sources":["Member.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAudA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Member.vue","sourceRoot":"src/components/item/setting","sourcesContent":["<template>\n  <div class=\"hello\">\n    <el-button type=\"text\" class=\"add-member\" @click=\"dialogFormVisible = true\">{{$t('add_member')}}</el-button>\n    <el-button\n      type=\"text\"\n      class=\"add-member\"\n      @click=\"dialogFormTeamVisible = true\"\n    >{{$t('add_team')}}</el-button>\n\n    <!-- 单个成员列表 -->\n    <el-table align=\"left\" v-if=\"members && members.length>0\" :data=\"members\" height=\"200\" style=\"width: 100%\">\n      <el-table-column prop=\"username\" :label=\"$t('member_username')\" width=\"100\"></el-table-column>\n      <el-table-column prop=\"name\" :label=\"$t('name')\"></el-table-column>\n      <el-table-column prop=\"CreatedAt\" :label=\"$t('add_time')\" width=\"100\" :formatter=\"dateFormat\"></el-table-column>\n      <el-table-column prop=\"member_group\" :label=\"$t('authority')\"></el-table-column>\n      <el-table-column prop :label=\"$t('operation')\">\n        <template slot-scope=\"scope\">\n          <el-button\n            @click=\"delete_member(scope.row.ID)\"\n            type=\"text\"\n            size=\"small\"\n          >{{$t('delete')}}</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 团队列表 -->\n    <el-table\n      align=\"left\"\n      v-if=\"teamItems.length>0\"\n      :data=\"teamItems\"\n      height=\"200\"\n      style=\"width: 100%\"\n    >\n      <el-table-column prop=\"teamname\" :label=\"$t('team_name')\"></el-table-column>\n      <el-table-column prop=\"created_at\" :label=\"$t('add_time')\" :formatter=\"dateFormat\"></el-table-column>\n\n      <el-table-column prop :label=\"$t('operation')\">\n        <template slot-scope=\"scope\">\n          <el-button\n            @click=\"getTeamItemMember(scope.row.team_id)\"\n            type=\"text\"\n            size=\"small\"\n          >{{$t('member_authority')}}</el-button>\n          <el-button @click=\"deleteTeam(scope.row.cid)\" type=\"text\" size=\"small\">{{$t('delete')}}</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 添加单个成员弹窗 -->\n    <el-dialog\n      :visible.sync=\"dialogFormVisible\"\n      :modal=\"false\"\n      top=\"10vh\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-form>\n        <el-form-item label>\n          <el-select\n            v-model=\"MyForm.username\"\n            multiple\n            filterable\n            reserve-keyword\n            placeholder\n          >\n            <el-option\n              v-for=\"item in memberOptions\"\n              :key=\"item.ID\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label class=\"readonly-checkbox\">\n          <el-checkbox v-model=\"MyForm.is_readonly\">{{$t('readonly')}}</el-checkbox>\n        </el-form-item>\n        <el-form-item label>\n          <el-select v-model=\"MyForm.cat_id\" :placeholder=\"$t('all_cat2')\">\n            <el-option\n              v-for=\"item in catalogs\"\n              :key=\"item.cat_id\"\n              :label=\"item.cat_name\"\n              :value=\"item.cat_id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n\n      <p class=\"tips\">{{$t('member_authority_tips')}}</p>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">{{$t('cancel')}}</el-button>\n        <el-button type=\"primary\" @click=\"MyFormSubmit\">{{$t('confirm')}}</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 添加团队弹窗 -->\n    <el-dialog\n      :visible.sync=\"dialogFormTeamVisible\"\n      :modal=\"false\"\n      top=\"10vh\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-form>\n        <el-form-item label=\"选择团队\">\n          <el-select class v-model=\"MyForm2.team_id\">\n            <el-option\n              v-for=\"team in teams \"\n              :key=\"team.teamname\"\n              :label=\"team.teamname\"\n              :value=\"team.ID\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <router-link to=\"/team/index\" target=\"\">{{$t('go_to_new_an_team')}}</router-link>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormTeamVisible = false\">{{$t('cancel')}}</el-button>\n        <el-button type=\"primary\" @click=\"addTeam\">{{$t('confirm')}}</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 成员权限弹窗 -->\n    <el-dialog\n      :visible.sync=\"dialogFormTeamMemberVisible\"\n      :modal=\"false\"\n      top=\"10vh\"\n      :title=\"$t('adjust_member_authority')\"\n      width=\"90%\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-table\n        align=\"left\"\n        :empty-text=\"$t('team_member_empty_tips')\"\n        :data=\"teamItemMembers\"\n        style=\"width: 100%\"\n      >\n        <el-table-column prop=\"member_username\" :label=\"$t('username')\"></el-table-column>\n        <el-table-column prop=\"member_group_id\" :label=\"$t('authority')\" width=\"130\">\n          <template slot-scope=\"scope\">\n            <el-select\n              size=\"mini\"\n              v-model=\"scope.row.member_group_id\"\n              @change=\"changeTeamItemMemberGroup($event,scope.row.ID)\"\n              :placeholder=\"$t('please_choose')\"\n            >\n              <el-option\n                v-for=\"item in authorityOptions\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"cat_id\" :label=\"$t('catalog')\" width=\"130\">\n          <template slot-scope=\"scope\">\n            <el-select\n              size=\"mini\"\n              v-model=\"scope.row.cat_id\"\n              @change=\"changeTeamItemMemberCat($event,scope.row.ID)\"\n              :placeholder=\"$t('please_choose')\"\n            >\n              <el-option\n                v-for=\"item in catalogs\"\n                :key=\"item.cat_id\"\n                :label=\"item.cat_name\"\n                :value=\"item.cat_id\"\n              ></el-option>\n            </el-select>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"addtime\" :label=\"$t('add_time')\"></el-table-column>\n      </el-table>\n      <br />\n      <p class=\"tips\">{{$t('team_member_authority_tips')}}</p>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormTeamMemberVisible = false\">{{$t('close')}}</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nconst moment = require('moment')\nexport default {\n  name: 'Login',\n  components: {},\n  data () {\n    return {\n      MyForm: {\n        username: '',\n        is_readonly: false\n      },\n      MyForm2: {\n        team_id: ''\n      },\n      members: [],\n      dialogFormVisible: false,\n      dialogFormTeamVisible: false,\n      dialogFormTeamMemberVisible: false,\n      teams: [],\n      teamItems: [],\n      teamItemMembers: [],\n      authorityOptions: [\n        {\n          label: '编辑',\n          value: 1\n        },\n        {\n          label: '只读',\n          value: 0\n        }\n      ],\n      memberOptions: [],\n      catalogs: []\n    }\n  },\n  methods: {\n    dateFormat: function (row, column) {\n      var date = row[column.property]\n      if (date === undefined) {\n        return ''\n      }\n      return moment(date).format('YYYY-MM-DD HH:mm:ss')\n    },\n    get_members () {\n      var that = this\n      var url = DocConfig.server + '/itemmember/getList'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          that.members = Info\n          that.getAllUser()\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    get_teams () {\n      var that = this\n      var url = DocConfig.server + '/team/list'\n      var params = new URLSearchParams()\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          that.teams = Info\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    getTeamItem () {\n      var that = this\n      var url = DocConfig.server + '/teamitem/list'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          that.teamItems = Info\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    getTeamItemMember (team_id) {\n      var that = this\n      this.dialogFormTeamMemberVisible = true\n      var url = DocConfig.server + '/teamitemmember/list'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      params.append('team_id', team_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          that.teamItemMembers = Info\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    MyFormSubmit () {\n      var that = this\n      var url = DocConfig.server + '/itemmember/save'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      params.append('username', this.MyForm.username)\n      params.append('cat_id', this.MyForm.cat_id)\n      var member_group_id = 1\n      if (this.MyForm.is_readonly) {\n        member_group_id = 0\n      }\n      params.append('member_group_id', member_group_id)\n      that.$http\n        .post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            that.dialogFormVisible = false\n            that.get_members()\n            that.MyForm.username = ''\n            that.MyForm.is_readonly = false\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    addTeam () {\n      var that = this\n      var url = DocConfig.server + '/teamitem/save'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      params.append('team_id', this.MyForm2.team_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          that.dialogFormTeamVisible = false\n          that.getTeamItem()\n          that.MyForm.team_id = ''\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    delete_member (item_member_id) {\n      var that = this\n      var url = DocConfig.server + '/itemmember/delete'\n      this.$confirm(that.$t('confirm_delete'), ' ', {\n        confirmButtonText: that.$t('confirm'),\n        cancelButtonText: that.$t('cancel'),\n        type: 'warning'\n      }).then(() => {\n        var params = new URLSearchParams()\n        params.append('item_id', that.$route.params.item_id)\n        params.append('item_member_id', item_member_id)\n        that.$http.post(url, params).then(function (response) {\n          if (response.data.status === 200) {\n            that.get_members()\n            // window.location.reload()\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n      })\n    },\n    deleteTeam (ID) {\n      var that = this\n      var url = DocConfig.server + '/teamitem/delete'\n      this.$confirm(that.$t('confirm_delete'), ' ', {\n        confirmButtonText: that.$t('confirm'),\n        cancelButtonText: that.$t('cancel'),\n        type: 'warning'\n      }).then(() => {\n        var params = new URLSearchParams()\n        params.append('id', ID)\n        that.$http.post(url, params).then(function (response) {\n          if (response.data.status === 200) {\n            that.getTeamItem()\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n      })\n    },\n    changeTeamItemMemberGroup (member_group_id, ID) {\n      var that = this\n      var url = DocConfig.server + '/teamitemmember/save'\n      var params = new URLSearchParams()\n      params.append('memberGroupId', member_group_id)\n      params.append('id', ID)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          that.$message(that.$t('auth_success'))\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    getAllUser (queryString) {\n      var that = this\n      var url = DocConfig.server + '/admin/user'\n      var params = new URLSearchParams()\n      if (!queryString) {\n        queryString = ''\n      }\n      params.append('username', queryString)\n      that.$http.post(url, params).then(response => {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          var newInfo = []\n          // 过滤掉已经是成员的用户\n          for (var i = 0; i < Info.length; i++) {\n            const isMember = that.isMember(Info[i].value)\n            if (!isMember) {\n              newInfo.push(Info[i])\n            }\n          }\n          that.memberOptions = []\n          for (let index = 0; index < newInfo.length; index++) {\n            that.memberOptions.push({\n              value: newInfo[index].value,\n              label: newInfo[index].value,\n              key: newInfo[index].value\n            })\n          }\n          return (Info)\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    },\n    // 判断某个用户是否已经是会员\n    isMember (username) {\n      const list = this.members\n      if (list !== null) {\n        for (let i = 0; i < list.length; i++) {\n          if (list[i].username === username) {\n            return true\n          }\n        }\n        return false\n      }\n    },\n    get_catalog () {\n      var that = this\n      var url = DocConfig.server + '/catListGroup'\n      var params = new URLSearchParams()\n      params.append('item_id', that.$route.params.item_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          var Info = response.data.data\n          Info.unshift({\n            cat_id: 0,\n            cat_name: that.$t('all_cat')\n          })\n          that.catalogs = Info\n        } else {\n          that.$message(response.data.message)\n        }\n      })\n    },\n    changeTeamItemMemberCat (cat_id, id) {\n      var that = this\n      var url = DocConfig.server + '/teamitemmember/save'\n      var params = new URLSearchParams()\n      params.append('cat_id', cat_id)\n      params.append('id', id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          that.$message(that.$t('cat_success'))\n        } else {\n          that.$alert(response.data.message)\n        }\n      })\n    }\n  },\n  mounted () {\n    this.get_members()\n    this.get_teams()\n    this.getTeamItem()\n    this.getAllUser()\n    this.get_catalog()\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.hello {\n  text-align: left;\n}\n.add-member {\n  margin-left: 10px;\n}\n.tips {\n  font-size: 12px;\n  margin-bottom: 0px;\n  margin-top: 0px;\n}\n</style>\n"]}]}