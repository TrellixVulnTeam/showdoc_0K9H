{"remainingRequest":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/SortPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/SortPage.vue","mtime":1621237691542},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkcmFnZ2FibGUgZnJvbSAndnVlZHJhZ2dhYmxlJwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGNhbGxiYWNrOiAnJywKICAgIHBhZ2VfaWQ6ICcnLAogICAgaXRlbV9pZDogJycsCiAgICBpc19tb2RhbDogdHJ1ZSwKICAgIGJlbG9uZ190b19jYXRhbG9nczoge30sCiAgICBjYXRfaWQ6ICcnCiAgfSwKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnREYXRlOiBuZXcgRGF0ZSgpLAogICAgICBkaWFsb2dUYWJsZVZpc2libGU6IGZhbHNlLAogICAgICBwYWdlczogW10KICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIGRyYWdnYWJsZQogIH0sCiAgbWV0aG9kczogewogICAgc2hvdyAoKSB7CiAgICAgIHRoaXMuZGlhbG9nVGFibGVWaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIC8vIOiOt+WPluafkOebruW9leS4i+eahOaJgOaciemhtemdogogICAgZ2V0X3BhZ2VzICgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgIHZhciB1cmwgPSB0aGlzLkRvY0NvbmZpZy5zZXJ2ZXIgKyAnL2NhdGFsb2cvZ2V0UGFnZXNCeWNhdCcKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICBwYXJhbXMuYXBwZW5kKCdpdGVtX2lkJywgdGhpcy5pdGVtX2lkKQogICAgICBwYXJhbXMuYXBwZW5kKCdjYXRfaWQnLCB0aGlzLmNhdF9pZCkKICAgICAgdGhhdC4kaHR0cAogICAgICAgIC5wb3N0KHVybCwgcGFyYW1zKQogICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgdGhhdC5wYWdlcyA9IHJlc3BvbnNlLmRhdGEuZGF0YQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhhdC4kYWxlcnQocmVzcG9uc2UuZGF0YS5tZXNzYWdlKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgICAgfSkKICAgIH0sCiAgICBlbmRNb3ZlIChldnQpIHsKICAgICAgY29uc3QgZGF0YSA9IHt9CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYWdlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHRoaXMucGFnZXNbaV0uSUQKICAgICAgICBkYXRhW2tleV0gPSBpICsgMQogICAgICB9CiAgICAgIHRoaXMuc29ydF9wYWdlKGRhdGEpCiAgICB9LAogICAgc29ydF9wYWdlIChkYXRhKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpcwogICAgICB2YXIgdXJsID0gdGhpcy5Eb2NDb25maWcuc2VydmVyICsgJy9wYWdlL3NvcnQnCiAgICAgIHZhciBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCkKICAgICAgcGFyYW1zLmFwcGVuZCgncGFnZXMnLCBKU09OLnN0cmluZ2lmeShkYXRhKSkKICAgICAgcGFyYW1zLmFwcGVuZCgnaXRlbV9pZCcsIHRoaXMuaXRlbV9pZCkKICAgICAgdGhhdC4kaHR0cC5wb3N0KHVybCwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGF0LmdldF9wYWdlcygpCiAgICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoYXQuJGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSwgJycsIHsKICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCkKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgY2F0X2lkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuZ2V0X3BhZ2VzKCkKICAgIH0sCiAgICBkaWFsb2dUYWJsZVZpc2libGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5nZXRfcGFnZXMoKQogICAgfQogIH0sCiAgbW91bnRlZCAoKSB7fQp9Cg=="},{"version":3,"sources":["SortPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SortPage.vue","sourceRoot":"src/components/page/edit","sourcesContent":["<!-- 页面排序 -->\n<template>\n  <div class=\"hello\">\n    <Header></Header>\n\n    <el-container class=\"container-narrow\">\n      <el-dialog\n        :title=\"$t('sort_pages')\"\n        :modal=\"is_modal\"\n        :visible.sync=\"dialogTableVisible\"\n        :close-on-click-modal=\"false\"\n      >\n        <div class=\"dialog-body\">\n          <p class=\"tips\">{{ $t('sort_pages_tips') }}</p>\n          <el-select\n            :placeholder=\"$t('optional')\"\n            class=\"select-cat\"\n            v-model=\"cat_id\"\n            v-if=\"belong_to_catalogs\"\n          >\n            <el-option\n              v-for=\"cat in belong_to_catalogs\"\n              :key=\"cat.cat_name\"\n              :label=\"cat.cat_name\"\n              :value=\"cat.cat_id\"\n            ></el-option>\n          </el-select>\n          <draggable v-model=\"pages\" tag=\"div\" group=\"page\" @end=\"endMove\">\n            <div class=\"page-box\" v-for=\"page in pages\" :key=\"page.ID\">\n              <span class=\"page-name\">{{ page.pagetitle }}</span>\n            </div>\n          </draggable>\n        </div>\n      </el-dialog>\n    </el-container>\n    <Footer></Footer>\n    <div class></div>\n  </div>\n</template>\n\n<style scoped>\n.dialog-body {\n  min-height: 400px;\n  max-height: 90%;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.page-box {\n  background-color: rgb(250, 250, 250);\n  width: 98%;\n  height: 40px;\n  margin-top: 10px;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n}\n.page-name {\n  line-height: 40px;\n  margin-left: 20px;\n  color: #262626;\n}\n.tips {\n  margin-left: 10px;\n  color: #9ea1a6;\n  font-size: 11px;\n}\n</style>\n\n<script>\nimport draggable from 'vuedraggable'\nexport default {\n  props: {\n    callback: '',\n    page_id: '',\n    item_id: '',\n    is_modal: true,\n    belong_to_catalogs: {},\n    cat_id: ''\n  },\n  data () {\n    return {\n      currentDate: new Date(),\n      dialogTableVisible: false,\n      pages: []\n    }\n  },\n  components: {\n    draggable\n  },\n  methods: {\n    show () {\n      this.dialogTableVisible = true\n    },\n    // 获取某目录下的所有页面\n    get_pages () {\n      var that = this\n      var url = this.DocConfig.server + '/catalog/getPagesBycat'\n      var params = new URLSearchParams()\n      params.append('item_id', this.item_id)\n      params.append('cat_id', this.cat_id)\n      that.$http\n        .post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            that.pages = response.data.data\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    endMove (evt) {\n      const data = {}\n      for (var i = 0; i < this.pages.length; i++) {\n        const key = this.pages[i].ID\n        data[key] = i + 1\n      }\n      this.sort_page(data)\n    },\n    sort_page (data) {\n      var that = this\n      var url = this.DocConfig.server + '/page/sort'\n      var params = new URLSearchParams()\n      params.append('pages', JSON.stringify(data))\n      params.append('item_id', this.item_id)\n      that.$http.post(url, params).then(function (response) {\n        if (response.data.status === 200) {\n          that.get_pages()\n          // window.location.reload();\n        } else {\n          that.$alert(response.data.message, '', {\n            callback: function () {\n              window.location.reload()\n            }\n          })\n        }\n      })\n    }\n  },\n  watch: {\n    cat_id: function () {\n      this.get_pages()\n    },\n    dialogTableVisible: function () {\n      this.get_pages()\n    }\n  },\n  mounted () {}\n}\n</script>\n"]}]}