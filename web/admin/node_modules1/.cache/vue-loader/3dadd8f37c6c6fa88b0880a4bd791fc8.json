{"remainingRequest":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/HistoryVersion.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/HistoryVersion.vue","mtime":1621307162477},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgY2FsbGJhY2s6ICcnLAogICAgcGFnZV9pZDogJycsCiAgICBpc19tb2RhbDogdHJ1ZSwKICAgIGlzX3Nob3dfcmVjb3Zlcl9idG46IHRydWUKICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VycmVudERhdGU6IG5ldyBEYXRlKCksCiAgICAgIGNvbnRlbnQ6IFtdLAogICAgICBkaWFsb2dUYWJsZVZpc2libGU6IGZhbHNlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgfSwKICBtZXRob2RzOiB7CiAgICBkYXRlRm9ybWF0OiBmdW5jdGlvbiAocm93LCBjb2x1bW4pIHsKICAgICAgdmFyIGRhdGUgPSByb3dbY29sdW1uLnByb3BlcnR5XQogICAgICBpZiAoZGF0ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuICcnCiAgICAgIH0KICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKQogICAgfSwKICAgIGdldF9jb250ZW50ICgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgIHZhciB1cmwgPSB0aGlzLkRvY0NvbmZpZy5zZXJ2ZXIgKyAnL3BhZ2UvaGlzdG9yeScKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICBwYXJhbXMuYXBwZW5kKCdwYWdlX2lkJywgdGhhdC5wYWdlX2lkKQogICAgICB0aGF0LiRodHRwLnBvc3QodXJsLCBwYXJhbXMpCiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAvLyB0aGF0LiRtZXNzYWdlLnN1Y2Nlc3MoIuWKoOi9veaIkOWKnyIpOwogICAgICAgICAgICB2YXIganNvbiA9IHJlc3BvbnNlLmRhdGEuZGF0YQogICAgICAgICAgICBpZiAoanNvbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgdGhhdC5jb250ZW50ID0gcmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgICAgICAgdGhhdC5kaWFsb2dUYWJsZVZpc2libGUgPSB0cnVlCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhhdC5kaWFsb2dUYWJsZVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgIHRoYXQuJGFsZXJ0KCdubyBkYXRhJykKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhhdC5kaWFsb2dUYWJsZVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICB0aGF0LiRhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICB9KQogICAgfSwKICAgIHNob3cgKCkgewogICAgICB0aGlzLmdldF9jb250ZW50KCkKICAgIH0sCiAgICByZWNvdmVyIChyb3cpIHsKICAgICAgdGhpcy5jYWxsYmFjayhyb3cucGFnZV9jb250ZW50LCB0cnVlKQogICAgICB0aGlzLmRpYWxvZ1RhYmxlVmlzaWJsZSA9IGZhbHNlCiAgICB9LAogICAgcHJldmlld19kaWZmIChyb3cpIHsKICAgICAgdmFyIHBhZ2VfaGlzdG9yeV9pZCA9IHJvdy5wYWdlLnBhZ2VfaGlzdG9yeV9pZAogICAgICB2YXIgcGFnZV9pZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5wYWdlX2lkCiAgICAgIHZhciB1cmwgPSAnIy9wYWdlL2RpZmYvJyArIHBhZ2VfaWQgKyAnLycgKyBwYWdlX2hpc3RvcnlfaWQKICAgICAgd2luZG93Lm9wZW4odXJsKQogICAgfQogIH0sCiAgbW91bnRlZCAoKSB7CgogIH0KfQo="},{"version":3,"sources":["HistoryVersion.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"HistoryVersion.vue","sourceRoot":"src/components/page/edit","sourcesContent":["<template>\n  <div class=\"hello\">\n    <Header> </Header>\n\n    <el-container class=\"container-narrow\">\n\n      <el-dialog :title=\"$t('history_version')\" :modal=\"is_modal\" :visible.sync=\"dialogTableVisible\" :close-on-click-modal=\"false\">\n        <el-table :data=\"content\">\n          <el-table-column property=\"CreatedAt\" :label=\"$t('update_time')\" width=\"170\" :formatter=\"dateFormat\"></el-table-column>\n          <el-table-column property=\"authorusername\" :label=\"$t('update_by_who')\" ></el-table-column>\n          <el-table-column property=\"pagecomments\" :label=\"$t('remark')\">\n            <template slot-scope=\"scope\">\n              {{ scope.row.page_comments }}\n              <el-button v-if=\"is_show_recover_btn\" @click=\"editComments(scope.row)\" type=\"text\" size=\"small\">{{ $t('edit') }}</el-button>\n            </template>\n          </el-table-column>\n          <el-table-column\n            label=\"操作\"\n            width=\"150\">\n            <template slot-scope=\"scope\">\n              <el-button @click=\"preview_diff(scope.row)\" type=\"text\" size=\"small\">{{$t('overview')}}</el-button>\n              <el-button v-if=\"is_show_recover_btn\" type=\"text\" size=\"small\" @click=\"recover(scope.row)\">{{$t('recover_to_this_version')}}</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-dialog>\n\n      </el-container>\n    <Footer> </Footer>\n    <div class=\"\"></div>\n  </div>\n</template>\n\n<style>\n</style>\n\n<script>\nconst moment = require('moment')\nexport default {\n  props: {\n    callback: '',\n    page_id: '',\n    is_modal: true,\n    is_show_recover_btn: true\n  },\n  data () {\n    return {\n      currentDate: new Date(),\n      content: [],\n      dialogTableVisible: false\n    }\n  },\n  components: {\n  },\n  methods: {\n    dateFormat: function (row, column) {\n      var date = row[column.property]\n      if (date === undefined) {\n        return ''\n      }\n      return moment(date).format('YYYY-MM-DD HH:mm:ss')\n    },\n    get_content () {\n      var that = this\n      var url = this.DocConfig.server + '/page/history'\n      var params = new URLSearchParams()\n      params.append('page_id', that.page_id)\n      that.$http.post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            // that.$message.success(\"加载成功\");\n            var json = response.data.data\n            if (json.length > 0) {\n              that.content = response.data.data\n              that.dialogTableVisible = true\n            } else {\n              that.dialogTableVisible = false\n              that.$alert('no data')\n            }\n          } else {\n            that.dialogTableVisible = false\n            that.$alert(response.data.message)\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    show () {\n      this.get_content()\n    },\n    recover (row) {\n      this.callback(row.page_content, true)\n      this.dialogTableVisible = false\n    },\n    preview_diff (row) {\n      var page_history_id = row.page.page_history_id\n      var page_id = this.$route.params.page_id\n      var url = '#/page/diff/' + page_id + '/' + page_history_id\n      window.open(url)\n    }\n  },\n  mounted () {\n\n  }\n}\n</script>\n"]}]}