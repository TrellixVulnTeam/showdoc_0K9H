{"remainingRequest":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/Index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/Index.vue","mtime":1622549475479},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFZGl0b3JtZCBmcm9tICdAL2NvbXBvbmVudHMvY29tbW9uL0VkaXRvcm1kJwppbXBvcnQgSnNvblRvVGFibGUgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9Kc29uVG9UYWJsZScKaW1wb3J0IEpzb25CZWF1dGlmeSBmcm9tICdAL2NvbXBvbmVudHMvY29tbW9uL0pzb25CZWF1dGlmeScKaW1wb3J0IFRlbXBsYXRlTGlzdCBmcm9tICdAL2NvbXBvbmVudHMvcGFnZS9lZGl0L1RlbXBsYXRlTGlzdCcKaW1wb3J0IEhpc3RvcnlWZXJzaW9uIGZyb20gJ0AvY29tcG9uZW50cy9wYWdlL2VkaXQvSGlzdG9yeVZlcnNpb24nCmltcG9ydCBBdHRhY2htZW50TGlzdCBmcm9tICdAL2NvbXBvbmVudHMvcGFnZS9lZGl0L0F0dGFjaG1lbnRMaXN0JwppbXBvcnQgUGFzdGVUYWJsZSBmcm9tICdAL2NvbXBvbmVudHMvcGFnZS9lZGl0L1Bhc3RlVGFibGUnCmltcG9ydCBTb3J0UGFnZSBmcm9tICdAL2NvbXBvbmVudHMvcGFnZS9lZGl0L1NvcnRQYWdlJwppbXBvcnQgeyByZWRlclBhZ2VDb250ZW50IH0gZnJvbSAnQC9tb2RlbHMvcGFnZScKaW1wb3J0IHsKICBhcGlUZW1wbGF0ZVpoLAogIGRhdGFiYXNlVGVtcGxhdGVaaCwKICBhcGlUZW1wbGF0ZUVuLAogIGRhdGFiYXNlVGVtcGxhdGVFbgp9IGZyb20gJ0AvbW9kZWxzL3RlbXBsYXRlJwovLyB2YXIgJHMgPSByZXF1aXJlKCdzY3JpcHRqcycpCnZhciAkID0gcmVxdWlyZSgnanF1ZXJ5JykKCmV4cG9ydCBkZWZhdWx0IHsKCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50RGF0ZTogbmV3IERhdGUoKSwKICAgICAgaXRlbUxpc3Q6IHt9LAogICAgICBjb250ZW50OiAnJywKICAgICAgdGl0bGU6ICcnLAogICAgICBpdGVtX2lkOiAwLAogICAgICBzX251bWJlcjogJycsCiAgICAgIHBhZ2VfaWQ6ICcnLAogICAgICBjaWQ6ICcnLAogICAgICBuYW1lOiAnJywKICAgICAgY2F0X2lkOiAwLAogICAgICBjb3B5X3BhZ2VfaWQ6ICcnLAogICAgICBhdHRhY2htZW50X2NvdW50OiAnJywKICAgICAgY2F0YWxvZ3M6IFtdLAogICAgICBpc0xvY2s6IDAsCiAgICAgIGludGVydmFsSWQ6IDAsCiAgICAgIHNhdmluZzogZmFsc2UsCiAgICAgIGxhbmc6ICcnLAogICAgICBsYW5nczogW10KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDmlrDlu7ov57yW6L6R55uu5b2V5pe25L6b55So5oi36YCJ5oup55qE5LiK57qn55uu5b2V5YiX6KGoCiAgICBiZWxvbmdfdG9fY2F0YWxvZ3M6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmNhdGFsb2dzIHx8IHRoaXMuY2F0YWxvZ3MubGVuZ3RoIDw9IDApIHsKICAgICAgICByZXR1cm4gW10KICAgICAgfQogICAgICB2YXIgSW5mbyA9IHRoaXMuY2F0YWxvZ3Muc2xpY2UoMCkKICAgICAgdmFyIGNhdF9hcnJheSA9IFtdCiAgICAgIC8vIOi/meS4quWHveaVsOWwhumAkuW9kgogICAgICB2YXIgcmVuYW1lID0gZnVuY3Rpb24gKGNhdGFsb2csIHBfY2F0X25hbWUpIHsKICAgICAgICBpZiAoY2F0YWxvZy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNhdGFsb2cubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgdmFyIGNhdF9uYW1lID0gcF9jYXRfbmFtZSArICcgLyAnICsgY2F0YWxvZ1tqXS5jYXRfbmFtZQogICAgICAgICAgICBjYXRfYXJyYXkucHVzaCh7CiAgICAgICAgICAgICAgY2F0X2lkOiBjYXRhbG9nW2pdLmNhdF9pZCwKICAgICAgICAgICAgICBjYXRfbmFtZTogY2F0X25hbWUKICAgICAgICAgICAgfSkKICAgICAgICAgICAgaWYgKGNhdGFsb2dbal0uc3ViICYmIGNhdGFsb2dbal0uc3ViLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICByZW5hbWUoY2F0YWxvZ1tqXS5zdWIsIGNhdF9uYW1lKQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgSW5mby5sZW5ndGg7IGkrKykgewogICAgICAgIGNhdF9hcnJheS5wdXNoKEluZm9baV0pCiAgICAgICAgaWYgKEluZm9baV0uc3ViICE9IG51bGwpIHsKICAgICAgICAgIHJlbmFtZShJbmZvW2ldLnN1YiwgSW5mb1tpXS5jYXRfbmFtZSkKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIG5vX2NhdCA9IHsgY2F0X2lkOiAwLCBjYXRfbmFtZTogdGhpcy4kdCgnbm9uZScpIH0KICAgICAgY2F0X2FycmF5LnB1c2gobm9fY2F0KQogICAgICByZXR1cm4gY2F0X2FycmF5CiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBFZGl0b3JtZCwKICAgIEpzb25Ub1RhYmxlLAogICAgSnNvbkJlYXV0aWZ5LAogICAgVGVtcGxhdGVMaXN0LAogICAgQXR0YWNobWVudExpc3QsCiAgICBQYXN0ZVRhYmxlLAogICAgU29ydFBhZ2UsCiAgICBIaXN0b3J5VmVyc2lvbgogIH0sCiAgbWV0aG9kczogewogICAgZ2V0X2xhbmcgKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvbGFuZycKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICB0aGF0LiRodHRwLmdldCh1cmwsIHBhcmFtcykKICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgIHRoYXQubGFuZ3MgPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0pCiAgICB9LAogICAgLy8g6I635Y+W6aG16Z2i5YaF5a65CiAgICBnZXRfcGFnZV9jb250ZW50IChwYWdlX2lkKSB7CiAgICAgIGlmICghcGFnZV9pZCkgewogICAgICAgIHBhZ2VfaWQgPSB0aGlzLnBhZ2VfaWQKICAgICAgfQogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvYWRtaW4vcGFnZScKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICBwYXJhbXMuYXBwZW5kKCdwYWdlX2lkJywgcGFnZV9pZCkKICAgICAgdGhhdC4kaHR0cC5wb3N0KHVybCwgcGFyYW1zKQogICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgLy8gdGhhdC4kbWVzc2FnZS5zdWNjZXNzKCLliqDovb3miJDlip8iKTsKICAgICAgICAgICAgdGhhdC5jb250ZW50ID0gcmVkZXJQYWdlQ29udGVudChyZXNwb25zZS5kYXRhLmRhdGEucGFnZWNvbnRlbnQpCiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHRoYXQuaW5zZXJ0VmFsdWUodGhhdC5jb250ZW50LCAxKQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDAgLy8g5Zue5Yiw6aG26YOoCiAgICAgICAgICAgIH0sIDUwMCkKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8g5aaC5p6c6ZW/5bqm5aSn5LqOMzAwMCzliJnlhbPpl63pooTop4gKICAgICAgICAgICAgICBpZiAodGhhdC5jb250ZW50Lmxlbmd0aCA+IDMwMDApIHsKICAgICAgICAgICAgICAgIHRoYXQuZWRpdG9yX3Vud2F0Y2goKQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGF0LmVkaXRvcl93YXRjaCgpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoYXQuZHJhZnQoKQogICAgICAgICAgICB9LCAxMDAwKQogICAgICAgICAgICB0aGF0LnRpdGxlID0gcmVzcG9uc2UuZGF0YS5kYXRhLnBhZ2V0aXRsZQogICAgICAgICAgICB0aGF0Lml0ZW1faWQgPSByZXNwb25zZS5kYXRhLmRhdGEuaXRlbWlkCiAgICAgICAgICAgIHRoYXQuc19udW1iZXIgPSByZXNwb25zZS5kYXRhLmRhdGEuc251bWJlcgogICAgICAgICAgICB0aGF0LmNpZCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jaWQKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoYXQuJGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0pCiAgICB9LAogICAgZ2V0X2NhdGFsb2cgKGl0ZW1faWQsIHZhbHVlKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpcwogICAgICB2YXIgdXJsID0gdGhpcy5Eb2NDb25maWcuc2VydmVyICsgJy9jYXRMaXN0R3JvdXAnCiAgICAgIHZhciBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCkKICAgICAgcGFyYW1zLmFwcGVuZCgnaXRlbV9pZCcsIGl0ZW1faWQpCiAgICAgIHBhcmFtcy5hcHBlbmQoJ2NpZCcsIHZhbHVlKQogICAgICBjb25zb2xlLmxvZyh2YWx1ZSkKICAgICAgdGhhdC4kaHR0cAogICAgICAgIC5wb3N0KHVybCwgcGFyYW1zKQogICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgdmFyIEluZm8gPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICAgICAgdGhhdC5jYXRhbG9ncyA9IEluZm8KCiAgICAgICAgICAgIHRoYXQuZ2V0X2RlZmF1bHRfY2F0KCkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoYXQuJGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0pCiAgICB9LAogICAgLy8g6I635Y+W6buY6K6k6K+l6YCJ5Lit55qE55uu5b2VCiAgICBnZXRfZGVmYXVsdF9jYXQgKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvZ2V0RGVmYXVsdENhdCcKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICBwYXJhbXMuYXBwZW5kKCdwYWdlX2lkJywgdGhpcy4kcm91dGUucGFyYW1zLnBhZ2VfaWQpCiAgICAgIHBhcmFtcy5hcHBlbmQoJ2l0ZW1faWQnLCB0aGF0LiRyb3V0ZS5wYXJhbXMuaXRlbV9pZCkKICAgICAgcGFyYW1zLmFwcGVuZCgnY29weV9wYWdlX2lkJywgdGhpcy5jb3B5X3BhZ2VfaWQpCiAgICAgIHRoYXQuJGh0dHAucG9zdCh1cmwsIHBhcmFtcykKICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vIHRoYXQuJG1lc3NhZ2Uuc3VjY2Vzcygi5Yqg6L295oiQ5YqfIikKICAgICAgICAgICAgdmFyIGpzb24gPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICAgICAgdGhhdC5jYXRfaWQgPSBqc29uCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGF0LiRhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0sCiAgICAvLyDmoLnmja7or63oqIDpgInmi6nnm67lvZUKICAgIHNlbGVjdENhdGFsb2cgKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdGhhdC5nZXRfY2F0YWxvZyh0aGlzLiRyb3V0ZS5wYXJhbXMuaXRlbV9pZCwgdGhpcy5jaWQpCiAgICB9LAogICAgLy8g5o+S5YWl5pWw5o2u5Yiw57yW6L6R5Zmo5Lit44CC5o+S5YWl5Yiw5YWJ5qCH5aSE44CC5aaC5p6c5Y+C5pWwaXNfY292ZXLkuLrnnJ/vvIzliJnmuIXnqbrlkI7lho3mj5LlhaUo5Y2z6KaG55uWKeOAggogICAgaW5zZXJ0VmFsdWUgKHZhbHVlLCBpc19jb3ZlcikgewogICAgICBpZiAodmFsdWUpIHsKICAgICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuRWRpdG9ybWQgLy8g6I635Y+W5a2Q57uE5Lu2CiAgICAgICAgaWYgKGlzX2NvdmVyKSB7CiAgICAgICAgICAvLyDmuIXnqboKICAgICAgICAgIGNoaWxkUmVmLmNsZWFyKCkKICAgICAgICB9OwogICAgICAgIGNoaWxkUmVmLmluc2VydFZhbHVlKHZhbHVlKSAvLyDosIPnlKjlrZDnu4Tku7bnmoTmlrnms5UKICAgICAgfTsKICAgIH0sCiAgICAvLyDmj5LlhaVhcGnmqKHmnb8KICAgIGluc2VydF9hcGlfdGVtcGxhdGUgKCkgewogICAgICB2YXIgdmFsCiAgICAgIGlmICh0aGlzLiRjb29raWVzLmdldCgnbG5nJykgPT09ICdaSF9DTicpIHsKICAgICAgICB2YWwgPSBhcGlUZW1wbGF0ZVpoCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsID0gYXBpVGVtcGxhdGVFbgogICAgICB9CiAgICAgIHRoaXMuaW5zZXJ0VmFsdWUodmFsKQogICAgfSwKICAgIC8vIOaPkuWFpeaVsOaNruWtl+WFuOaooeadvwogICAgaW5zZXJ0X2RhdGFiYXNlX3RlbXBsYXRlICgpIHsKICAgICAgdmFyIHZhbAogICAgICBpZiAodGhpcy4kY29va2llcy5nZXQoJ2xuZycpID09PSAnWkhfQ04nKSB7CiAgICAgICAgdmFsID0gZGF0YWJhc2VUZW1wbGF0ZVpoCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsID0gZGF0YWJhc2VUZW1wbGF0ZUVuCiAgICAgIH0KICAgICAgdGhpcy5pbnNlcnRWYWx1ZSh2YWwpCiAgICB9LAogICAgZWRpdG9yX3Vud2F0Y2ggKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuRWRpdG9ybWQgLy8g6I635Y+W5a2Q57uE5Lu2CiAgICAgIGNoaWxkUmVmLmVkaXRvcl91bndhdGNoKCkKICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3BhZ2VfaWRfdW53YXRjaF8nICsgdGhpcy5wYWdlX2lkKSkgewogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UodGhpcy4kdCgnbG9uZ19wYWdlX3RpcHMnKSkKICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdwYWdlX2lkX3Vud2F0Y2hfJyArIHRoaXMucGFnZV9pZCwgMSkKICAgICAgfQogICAgfSwKICAgIGVkaXRvcl93YXRjaCAoKSB7CiAgICAgIGNvbnN0IGNoaWxkUmVmID0gdGhpcy4kcmVmcy5FZGl0b3JtZCAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuZWRpdG9yX3dhdGNoKCkKICAgIH0sCiAgICAvLyBqc29u6L2s5Y+C5pWw6KGo5qC8CiAgICBTaG93SnNvblRvVGFibGUgKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuSnNvblRvVGFibGUgLy8g6I635Y+W5a2Q57uE5Lu2CiAgICAgIGNoaWxkUmVmLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIC8vIGpzb27moLzlvI/ljJYKICAgIFNob3dKc29uQmVhdXRpZnkgKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuSnNvbkJlYXV0aWZ5IC8vIOiOt+WPluWtkOe7hOS7tgogICAgICBjaGlsZFJlZi5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBTaG93UnVuQXBpICgpIHsKICAgICAgd2luZG93Lm9wZW4oJ2h0dHA6Ly9ydW5hcGkuZG9jLmNjLycpCiAgICB9LAogICAgLy8g5pu05aSa5qih5p2/44CB5qih5p2/5YiX6KGoCiAgICBTaG93VGVtcGxhdGVMaXN0ICgpIHsKICAgICAgY29uc3QgY2hpbGRSZWYgPSB0aGlzLiRyZWZzLlRlbXBsYXRlTGlzdCAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuc2hvdygpCiAgICB9LAogICAgU2hvd1Bhc3RlVGFibGUgKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuUGFzdGVUYWJsZSAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlCiAgICB9LAogICAgLy8g5bGV56S65Y6G5Y+y54mI5pysCiAgICBTaG93SGlzdG9yeVZlcnNpb24gKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuSGlzdG9yeVZlcnNpb24gLy8g6I635Y+W5a2Q57uE5Lu2CiAgICAgIGNoaWxkUmVmLnNob3coKQogICAgfSwKICAgIC8vIOWxleekuumhtemdouaOkuW6jwogICAgU2hvd1NvcnRQYWdlICgpIHsKICAgICAgdGhpcy5zYXZlKCgpID0+IHsKICAgICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuU29ydFBhZ2UgLy8g6I635Y+W5a2Q57uE5Lu2CiAgICAgICAgY2hpbGRSZWYuc2hvdygpCiAgICAgIH0pCiAgICB9LAogICAgc2F2ZSAoY2FsbGJhY2spIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgIGlmICh0aGlzLnNhdmluZykgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIHRoaXMuc2F2aW5nID0gdHJ1ZQogICAgICB2YXIgbG9hZGluZyA9IHRoYXQuJGxvYWRpbmcoKQogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuRWRpdG9ybWQKICAgICAgdmFyIGNvbnRlbnQgPSBjaGlsZFJlZi5nZXRNYXJrZG93bigpCiAgICAgIHZhciBjYXRfaWQgPSB0aGlzLmNhdF9pZAogICAgICB2YXIgaXRlbV9pZCA9IHRoYXQuJHJvdXRlLnBhcmFtcy5pdGVtX2lkCiAgICAgIHZhciBwYWdlX2lkID0gdGhhdC4kcm91dGUucGFyYW1zLnBhZ2VfaWQKICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvcGFnZS9zYXZlJwogICAgICB2YXIgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpCiAgICAgIHBhcmFtcy5hcHBlbmQoJ3BhZ2VfaWQnLCBwYWdlX2lkKQogICAgICBwYXJhbXMuYXBwZW5kKCdpdGVtX2lkJywgaXRlbV9pZCkKICAgICAgcGFyYW1zLmFwcGVuZCgnc19udW1iZXInLCB0aGF0LnNfbnVtYmVyKQogICAgICBwYXJhbXMuYXBwZW5kKCdwYWdlX3RpdGxlJywgdGhhdC50aXRsZSkKICAgICAgcGFyYW1zLmFwcGVuZCgnY2F0X2lkJywgY2F0X2lkKQogICAgICBwYXJhbXMuYXBwZW5kKCdjaWQnLCB0aGlzLmNpZCkKICAgICAgcGFyYW1zLmFwcGVuZCgncGFnZV9jb250ZW50JywgZW5jb2RlVVJJQ29tcG9uZW50KGNvbnRlbnQpKQogICAgICBwYXJhbXMuYXBwZW5kKCdpc191cmxlbmNvZGUnLCAxKQogICAgICB0aGF0LiRodHRwLnBvc3QodXJsLCBwYXJhbXMpCiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBsb2FkaW5nLmNsb3NlKCkKICAgICAgICAgIHRoYXQuc2F2aW5nID0gZmFsc2UKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICBjYWxsYmFjaygpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gdGhhdC4kbWVzc2FnZS5zdWNjZXNzKCLliqDovb3miJDlip8iKQogICAgICAgICAgICAgIC8vIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYWdlX2NvbnRlbnQnKQogICAgICAgICAgICAgIC8vIHRoYXQuJHJvdXRlci5wdXNoKHsgcGF0aDogJy8nICsgaXRlbV9pZCwgcXVlcnk6IHsgcGFnZV9pZDogcmVzcG9uc2UuZGF0YS5kYXRhLnBhZ2VfaWQgfSB9KQogICAgICAgICAgICAgIHRoYXQuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgICAgICAgbWVzc2FnZTogdGhhdC4kdCgnc2F2ZV9zdWNjZXNzJyksCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoYXQuZGVsZXRlRHJhZnQoKQogICAgICAgICAgICBpZiAocGFnZV9pZCA8PSAwKSB7CiAgICAgICAgICAgICAgdGhhdC4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgcGF0aDogJy9wYWdlL2VkaXQvJyArIGl0ZW1faWQgKyAnLycgKyByZXNwb25zZS5kYXRhLmRhdGEuSUQKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIHRoYXQucGFnZV9pZCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5JRAogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGF0LiRhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgLy8g6K6+572u5LiA5Liq5pyA6ZW/5YWz6Zet5pe26Ze0CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGxvYWRpbmcuY2xvc2UoKQogICAgICAgIHRoYXQuc2F2aW5nID0gZmFsc2UKICAgICAgfSwgMjAwMDApCiAgICB9LAogICAgZ29iYWNrICgpIHsKICAgICAgdmFyIHVybCA9ICcvJyArIHRoaXMuJHJvdXRlLnBhcmFtcy5pdGVtX2lkCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogdXJsLCBxdWVyeTogeyBwYWdlX2lkOiB0aGlzLiRyb3V0ZS5wYXJhbXMucGFnZV9pZCB9IH0pCiAgICB9LAogICAgZHJvcGRvd25fY2FsbGJhY2sgKGRhdGEpIHsKICAgICAgaWYgKGRhdGEpIHsKICAgICAgICBkYXRhKCkKICAgICAgfQogICAgfSwKICAgIC8vIOWPpuWtmOS4uuaooeadvwogICAgc2F2ZV90b190ZW1wbGF0ZSAoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpcwogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuRWRpdG9ybWQKICAgICAgdmFyIGNvbnRlbnQgPSBjaGlsZFJlZi5nZXRNYXJrZG93bigpCiAgICAgIHRoaXMuJHByb21wdCh0aGF0LiR0KCdzYXZlX3RlbXBsX3RpdGxlJyksICcgJywgewogICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvdGVtcGxhdGUvc2F2ZScKICAgICAgICB2YXIgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpCiAgICAgICAgcGFyYW1zLmFwcGVuZCgndGVtcGxhdGVfdGl0bGUnLCBkYXRhLnZhbHVlKQogICAgICAgIHBhcmFtcy5hcHBlbmQoJ3RlbXBsYXRlX2NvbnRlbnQnLCBjb250ZW50KQogICAgICAgIHRoYXQuJGh0dHAucG9zdCh1cmwsIHBhcmFtcykKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoYXQuJGFsZXJ0KHRoYXQuJHQoJ3NhdmVfdGVtcGxfdGV4dCcpKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoYXQuJGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCiAgICBTaG93QXR0YWNobWVudCAoKSB7CiAgICAgIGNvbnN0IGNoaWxkUmVmID0gdGhpcy4kcmVmcy5BdHRhY2htZW50TGlzdCAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuc2hvdygpCiAgICB9LAogICAgLyoqIOeymOi0tOS4iuS8oOWbvueJhyAqKi8KICAgIG9uX3Bhc3RlICgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgIHZhciB1cmwgPSB0aGlzLkRvY0NvbmZpZy5zZXJ2ZXIgKyAnL3VwbG9hZCcKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBjbGlwYm9hcmQgPSBlLmNsaXBib2FyZERhdGEKICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY2xpcGJvYXJkLml0ZW1zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICBpZiAoY2xpcGJvYXJkLml0ZW1zW2ldLmtpbmQgPT09ICdmaWxlJyB8fCBjbGlwYm9hcmQuaXRlbXNbaV0udHlwZS5pbmRleE9mKCdpbWFnZScpID4gLTEpIHsKICAgICAgICAgICAgdmFyIGltYWdlRmlsZSA9IGNsaXBib2FyZC5pdGVtc1tpXS5nZXRBc0ZpbGUoKQogICAgICAgICAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgICAgICAgIGZvcm0uYXBwZW5kKCd0JywgJ2FqYXgtdXBsb2FkcGljJykKICAgICAgICAgICAgZm9ybS5hcHBlbmQoJ2VkaXRvcm1kLWltYWdlLWZpbGUnLCBpbWFnZUZpbGUpCiAgICAgICAgICAgIHZhciBsb2FkaW5nID0gJycKICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKHR5cGUsIGRhdGEpIHsKICAgICAgICAgICAgICB0eXBlID0gdHlwZSB8fCAnYmVmb3JlJwogICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgICAgICAgLy8g5byA5aeL5LiK5LygCiAgICAgICAgICAgICAgICBjYXNlICdiZWZvcmUnOgogICAgICAgICAgICAgICAgICBsb2FkaW5nID0gdGhhdC4kbG9hZGluZygpCiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOi/lOWbnumUmeivrwogICAgICAgICAgICAgICAgY2FzZSAnZXJyb3InOgogICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCkKICAgICAgICAgICAgICAgICAgdGhhdC4kYWxlcnQoJ+WbvueJh+S4iuS8oOWksei0pScpCiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgIC8vIOS4iuS8oOaIkOWKnwogICAgICAgICAgICAgICAgY2FzZSAnc3VjY2Vzcyc6CiAgICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKQogICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzID09PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJyFbXSgvJyArIGRhdGEudXJsICsgJyknCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWUpCiAgICAgICAgICAgICAgICAgICAgdGhhdC5pbnNlcnRWYWx1ZSh2YWx1ZSkKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LiRhbGVydCgn5aSx6LSlJykKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0eXBlKQogICAgICAgICAgICB9CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLAogICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsCiAgICAgICAgICAgICAgZGF0YTogZm9ybSwKICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsCiAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLAogICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBzdGFuZGFyZC9uby1jYWxsYmFjay1saXRlcmFsCiAgICAgICAgICAgICAgICBjYWxsYmFjaygnYmVmb3JlJykKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgc3RhbmRhcmQvbm8tY2FsbGJhY2stbGl0ZXJhbAogICAgICAgICAgICAgICAgY2FsbGJhY2soJ2Vycm9yJykKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgc3RhbmRhcmQvbm8tY2FsbGJhY2stbGl0ZXJhbAogICAgICAgICAgICAgICAgY2FsbGJhY2soJ3N1Y2Nlc3MnLCBkYXRhKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIC8vIOiNieeovwogICAgZHJhZnQgKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdmFyIHBrZXkgPSAncGFnZV9jb250ZW50XycgKyB0aGlzLnBhZ2VfaWQKICAgICAgY29uc3QgY2hpbGRSZWYgPSB0aGlzLiRyZWZzLkVkaXRvcm1kCiAgICAgIC8vIOWumuaXtuS/neWtmOaWh+acrOWGheWuueWIsGxvY2FsU3RvcmFnZQogICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgdmFyIGNvbnRlbnQgPSBjaGlsZFJlZi5nZXRNYXJrZG93bigpCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0ocGtleSwgY29udGVudCkKICAgICAgfSwgMzAgKiAxMDAwKQogICAgICAvLyDmo4DmtYvmmK/lkKbmnInlrprml7bkv53lrZjnmoTlhoXlrrkKICAgICAgdmFyIHBhZ2VfY29udGVudCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHBrZXkpCiAgICAgIGlmICgKICAgICAgICBwYWdlX2NvbnRlbnQgJiYKICAgICAgICBwYWdlX2NvbnRlbnQubGVuZ3RoID4gMCAmJgogICAgICAgIHBhZ2VfY29udGVudCAhPT0gY2hpbGRSZWYuZ2V0TWFya2Rvd24oKSAmJgogICAgICAgIGNoaWxkUmVmLmdldE1hcmtkb3duKCkgJiYKICAgICAgICBjaGlsZFJlZi5nZXRNYXJrZG93bigpLmxlbmd0aCA+IDEwCiAgICAgICkgewogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHBrZXkpCiAgICAgICAgdGhhdAogICAgICAgICAgLiRjb25maXJtKHRoYXQuJHQoJ2RyYWZ0X3RpcHMnKSwgJycsIHsKICAgICAgICAgICAgc2hvd0Nsb3NlOiBmYWxzZQogICAgICAgICAgfSkKICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgdGhhdC5pbnNlcnRWYWx1ZShwYWdlX2NvbnRlbnQsIHRydWUpCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHBrZXkpCiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0ocGtleSkKICAgICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICAvLyDpgY3ljobliKDpmaTojYnnqL8KICAgIGRlbGV0ZURyYWZ0ICgpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2NhbFN0b3JhZ2UubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgbmFtZSA9IGxvY2FsU3RvcmFnZS5rZXkoaSkKICAgICAgICBpZiAobmFtZS5pbmRleE9mKCdwYWdlX2NvbnRlbnRfJykgPiAtMSkgewogICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obmFtZSkKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyDplIHlrpoKICAgIGFzeW5jIHNldExvY2sgKCkgewogICAgICB2YXIgdXJsID0gdGhpcy5Eb2NDb25maWcuc2VydmVyICsgJy9wYWdlL3NldExvY2snCiAgICAgIHZhciBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgIGZvcm1kYXRhLmFwcGVuZCgncGFnZV9pZCcsIHRoaXMucGFnZV9pZCkKICAgICAgZm9ybWRhdGEuYXBwZW5kKCdpdGVtX2lkJywgdGhpcy5pdGVtX2lkKQogICAgICBpZiAodGhpcy5wYWdlX2lkID4gMCkgewogICAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QodXJsLCBmb3JtZGF0YSkKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmlzTG9jayA9IDEKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyDop6PpmaTplIHlrpoKICAgIGFzeW5jIHVubG9jayAoKSB7CiAgICAgIGlmICghdGhpcy5pc0xvY2spIHsKICAgICAgICByZXR1cm4gLy8g5pys5p2l5aSE5LqO5pyq6ZSB5a6a5Lit55qE6K+d77yM5LiN5Y+R6LW36K+35rGCCiAgICAgIH0KICAgICAgdmFyIHVybCA9IHRoaXMuRG9jQ29uZmlnLnNlcnZlciArICcvcGFnZS9zZXRMb2NrJwogICAgICB2YXIgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBmb3JtZGF0YS5hcHBlbmQoJ3BhZ2VfaWQnLCB0aGlzLnBhZ2VfaWQpCiAgICAgIGZvcm1kYXRhLmFwcGVuZCgnaXRlbV9pZCcsIHRoaXMuaXRlbV9pZCkKICAgICAgZm9ybWRhdGEuYXBwZW5kKCdsb2NrX3RvJywgMTAwMCkKICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCh1cmwsIGZvcm1kYXRhKQogICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgdGhpcy5pc0xvY2sgPSAwCiAgICAgIH0KICAgIH0sCiAgICAvLyDlpoLmnpznlKjmiLflpITkuo7plIHlrprnirbmgIHnmoTor53vvIznlKjlv4Pot7Pkv53mjIHplIHlrpoKICAgIGhlYXJ0QmVhdExvY2sgKCkgewogICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuaXNMb2NrKSB7CiAgICAgICAgICB0aGlzLnNldExvY2soKQogICAgICAgIH0KICAgICAgfSwgMyAqIDYwICogMTAwMCkKICAgIH0sCiAgICAvLyDliKTmlq3pobXpnaLmmK/lkKbooqvplIHlrprnvJbovpEKICAgIGFzeW5jIHJlbW90ZUlzTG9jayAoKSB7CiAgICAgIHZhciB1cmwgPSB0aGlzLkRvY0NvbmZpZy5zZXJ2ZXIgKyAnL3BhZ2UvaXNMb2NrJwogICAgICB2YXIgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBmb3JtZGF0YS5hcHBlbmQoJ3BhZ2VfaWQnLCB0aGlzLnBhZ2VfaWQpCiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QodXJsLCBmb3JtZGF0YSkKICAgICAgLy8g5Yik5pat5bey57uP6ZSB5a6a5LqG5LiNCiAgICAgIGlmIChyZXMuZGF0YS5sb2NrID4gMCkgewogICAgICAgIGlmIChyZXMuZGF0YS5pc0N1clVzZXIgPiAwKSB7CiAgICAgICAgICB0aGlzLmlzTG9jayA9IDEKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kYWxlcnQodGhpcy4kdCgnbG9ja2luZycpICsgcmVzLmRhdGEubG9ja1VzZXJuYW1lKQogICAgICAgICAgdGhpcy5nb2JhY2soKQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldExvY2soKSAvLyDlpoLmnpzmsqHmnInooqvliKvkurrplIHlrprvvIzliJnov5vnvJbovpHpobXpnaLlkI7oh6rlt7HplIHlrprjgIIKICAgICAgfQogICAgfSwKICAgIC8vIOeUseS6jumhtemdouWFs+mXreS6i+S7tuaXoOazleebtOaOpeWPkei1t+W8guatpeeahGFqYXjor7fmsYLvvIzmiYDku6XnlKjmtY/op4jlmajnmoRuYXZpZ2F0b3Iuc2VuZEJlYWNvbuadpeWunueOsAogICAgdW5Mb2NrT25DbG9zZSAoKSB7CiAgICAgIGxldCB1c2VyX3Rva2VuID0gJycKICAgICAgY29uc3QgdXNlcmluZm9zdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcmluZm8nKQogICAgICBpZiAodXNlcmluZm9zdHIpIHsKICAgICAgICBjb25zdCB1c2VyaW5mbyA9IEpTT04ucGFyc2UodXNlcmluZm9zdHIpCiAgICAgICAgaWYgKHVzZXJpbmZvICYmIHVzZXJpbmZvLnVzZXJfdG9rZW4pIHsKICAgICAgICAgIHVzZXJfdG9rZW4gPSB1c2VyaW5mby51c2VyX3Rva2VuCiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IGFuYWx5dGljc0RhdGEgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsKICAgICAgICBwYWdlX2lkOiB0aGlzLnBhZ2VfaWQsCiAgICAgICAgaXRlbV9pZDogdGhpcy5pdGVtX2lkLAogICAgICAgIGxvY2tfdG86IDEwMDAsCiAgICAgICAgdXNlcl90b2tlbjogdXNlcl90b2tlbgogICAgICB9KQogICAgICBjb25zdCB1cmwgPSB0aGlzLkRvY0NvbmZpZy5zZXJ2ZXIgKyAnL3BhZ2Uvc2V0TG9jaycKICAgICAgaWYgKCdzZW5kQmVhY29uJyBpbiBuYXZpZ2F0b3IpIHsKICAgICAgICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbih1cmwsIGFuYWx5dGljc0RhdGEpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGNsaWVudCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpCiAgICAgICAgY2xpZW50Lm9wZW4oJ1BPU1QnLCB1cmwsIGZhbHNlKQogICAgICAgIGNsaWVudC5zZW5kKGFuYWx5dGljc0RhdGEpCiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgdmFyIHRoYXQgPSB0aGlzCiAgICB0aGlzLml0ZW1faWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaXRlbV9pZAogICAgdGhpcy5wYWdlX2lkID0gdGhpcy4kcm91dGUucGFyYW1zLnBhZ2VfaWQKICAgIHRoaXMuY29weV9wYWdlX2lkID0gdGhpcy4kcm91dGUucXVlcnkuY29weV9wYWdlX2lkID8gdGhpcy4kcm91dGUucXVlcnkuY29weV9wYWdlX2lkIDogJycKICAgIGlmICh0aGlzLmNvcHlfcGFnZV9pZCA+IDApIHsKICAgICAgdGhpcy5nZXRfcGFnZV9jb250ZW50KHRoaXMuY29weV9wYWdlX2lkKQogICAgfSBlbHNlIGlmICh0aGlzLnBhZ2VfaWQgPiAwKSB7CiAgICAgIHRoaXMuZ2V0X3BhZ2VfY29udGVudCh0aGlzLnBhZ2VfaWQpCiAgICB9IGVsc2UgewogICAgICB0aGlzLml0ZW1faWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaXRlbV9pZAogICAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLiR0KCd3ZWxjb21lX3VzZV9zaG93ZG9jJykKICAgIH0KICAgIHRoaXMuY2lkID0gdGhpcy5pdGVtTGlzdC5jaWQKICAgIHRoaXMuZ2V0X2NhdGFsb2codGhpcy4kcm91dGUucGFyYW1zLml0ZW1faWQpCiAgICB0aGlzLmdldF9sYW5nKCkKICAgIHRoaXMuaGVhcnRCZWF0TG9jaygpCiAgICB0aGlzLnJlbW90ZUlzTG9jaygpCiAgICB0aGF0Lm9uX3Bhc3RlKCkKICAgIGRvY3VtZW50Lm9ua2V5ZG93biA9IGZ1bmN0aW9uIChlKSB7IC8vIOWvueaVtOS4qumhtemdouaWh+aho+ebkeWQrCDlhbbplK7nm5jlv6vmjbfplK4KICAgICAgdmFyIGtleU51bSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2ggLy8g6I635Y+W6KKr5oyJ5LiL55qE6ZSu5YC8CiAgICAgIGlmIChrZXlOdW0gPT09IDgzICYmIGUuY3RybEtleSkgeyAvLyBDdHJsICtTIOS4uuS/neWtmAogICAgICAgIHRoYXQuc2F2ZSgpCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgIH0KICAgIH0KICAgIC8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgdGhpcy5vbl9wYXN0ZSkKICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLnVuTG9ja09uQ2xvc2UpCiAgfQogIC8vIGJlZm9yZURlc3Ryb3kgKCkgewogIC8vICAgLy8g6Kej6Zmk5a+557KY6LS05LiK5Lyg5Zu+54mH55qE55uR5ZCsCiAgLy8gICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwYXN0ZScsIHRoaXMub25fcGFzdGUpCiAgLy8gICB0aGlzLiRtZXNzYWdlLmNsb3NlQWxsKCkKICAvLyAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKQogIC8vICAgdGhpcy51bmxvY2soKQogIC8vICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMudW5Mb2NrT25DbG9zZSkKICAvLyB9Cn0K"},{"version":3,"sources":["Index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Index.vue","sourceRoot":"src/components/page/edit","sourcesContent":["<template>\n  <div class=\"hello\"\n   @keydown.ctrl.83.prevent=\"save\"\n    @keydown.meta.83.prevent=\"save\">\n    <Header> </Header>\n\n    <el-container class=\"container-narrow\">\n\n      <el-row class=\"masthead\">\n        <el-form :inline=\"true\"   class=\"demo-form-inline\" size=\"small\">\n          <el-form-item :label=\"$t('title')+' : '\">\n            <el-input  placeholder=\"\" v-model=\"title\"></el-input>\n          </el-form-item>\n          <el-form-item :label=\"$t('lang_setting')+' : '\">\n                <el-select  v-model=\"cid\" :placeholder=\"$t('lang_choose')\" class=\"lang\" @change=\"selectCatalog\">\n                <el-option\n                v-for=\"itemlang in langs\"\n                :key=\"itemlang.id\"\n                :label=\"itemlang.name\"\n                :value=\"itemlang.id\">\n               </el-option>\n              </el-select>\n            </el-form-item>\n          <el-form-item :label=\"$t('catalog') + ' : '\">\n            <el-select\n              :placeholder=\"$t('optional')\"\n              class=\"cat\"\n              v-model=\"cat_id\"\n              v-if=\"belong_to_catalogs\"\n            >\n             <el-option\n                v-for=\"cat in belong_to_catalogs\"\n                :key=\"cat.cat_name\"\n                :label=\"cat.cat_name\"\n                :value=\"cat.cat_id\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n            <el-form-item label>\n            <el-button type=\"text\" @click=\"ShowSortPage\">{{\n              $t('sort_pages')\n            }}</el-button>\n          </el-form-item>\n          <el-form-item label>\n            <el-button type=\"text\" @click=\"ShowHistoryVersion\">{{\n              $t('history_version')\n            }}</el-button>\n          </el-form-item>\n          <el-form-item class=\"pull-right\">\n              <el-dropdown  @command=\"dropdown_callback\" split-button type=\"primary\" size=\"medium\" trigger=\"click\" @click=\"save\" title=\"Ctrl + S\">\n                <span id=\"save-page\">{{ $t('save') }}</span>\n                <el-dropdown-menu slot=\"dropdown\">\n                  <el-dropdown-item :command=\"save_to_template\">{{$t('save_to_templ')}}</el-dropdown-item>\n                  <el-tooltip\n                  class=\"item\"\n                  effect=\"dark\"\n                  :content=\"$t('lock_edit_tips')\"\n                  placement=\"left\"\n                >\n                  <el-dropdown-item v-if=\"!isLock\" :command=\"setLock\">{{\n                    $t('lock_edit')\n                  }}</el-dropdown-item>\n                </el-tooltip>\n                <el-dropdown-item v-if=\"isLock\" :command=\"unlock\">{{\n                  $t('cacel_lock')\n                }}</el-dropdown-item>\n                  <!-- <el-dropdown-item>保存前添加注释</el-dropdown-item> -->\n                </el-dropdown-menu>\n              </el-dropdown>\n            <el-button type=\"\" size=\"medium\" @click=\"goback\">{{$t('cancel')}}</el-button>\n          </el-form-item>\n        </el-form>\n\n        <el-row class=\"fun-btn-group\">\n          <el-button type=\"\" size=\"medium\" @click=\"insert_api_template\">{{$t('insert_apidoc_template')}}</el-button>\n          <el-button type=\"\" size=\"medium\" @click=\"insert_database_template\">{{$t('insert_database_doc_template')}}</el-button>\n          <el-button type=\"\" size=\"medium\" @click.native=\"ShowTemplateList\">{{$t('more_templ')}}</el-button>\n            <el-dropdown split-button type=\"\" style=\"margin-left:100px;\" size=\"medium\" trigger=\"hover\" >\n              {{$t('json_tools')}}\n              <el-dropdown-menu slot=\"dropdown\">\n                <el-dropdown-item @click.native=\"ShowJsonToTable\">{{$t('json_to_table')}}</el-dropdown-item>\n                <el-dropdown-item @click.native=\"ShowJsonBeautify\">{{$t('beautify_json')}}</el-dropdown-item>\n                <el-dropdown-item @click.native=\"ShowPasteTable\">{{$t('paste_insert_table')}}</el-dropdown-item>\n              </el-dropdown-menu>\n            </el-dropdown>\n          <el-button type=\"\" size=\"medium\" @click=\"ShowRunApi\">{{$t('http_test_api')}}</el-button>\n          <el-badge :value=\"attachment_count\" class=\"item\">\n            <el-button type size=\"medium\" @click=\"ShowAttachment\">{{$t('attachment')}}</el-button>\n          </el-badge>\n        </el-row>\n\n        <Editormd v-bind:content=\"content\" v-if=\"content\" ref=\"Editormd\"  type=\"editor\" ></Editormd>\n\n      </el-row>\n\n        <!-- 更多模板 -->\n        <TemplateList :callback=\"insertValue\" ref=\"TemplateList\"></TemplateList>\n\n        <!-- 历史版本 -->\n        <HistoryVersion :callback=\"insertValue\" ref=\"HistoryVersion\"></HistoryVersion>\n\n        <!-- Json转表格 组件 -->\n        <JsonToTable   :callback=\"insertValue\" ref=\"JsonToTable\" ></JsonToTable>\n\n        <!-- Json格式化 -->\n        <JsonBeautify :callback=\"insertValue\" ref=\"JsonBeautify\"></JsonBeautify>\n\n        <!-- 附件列表 -->\n      <AttachmentList\n        :callback=\"insertValue\"\n        :item_id=\"item_id\"\n        :manage=\"true\"\n        :page_id=\"page_id\"\n        ref=\"AttachmentList\"\n      ></AttachmentList>\n       <!-- 粘贴插入表格 -->\n      <PasteTable\n        :callback=\"insertValue\"\n        :item_id=\"item_id\"\n        :manage=\"true\"\n        :page_id=\"page_id\"\n        ref=\"PasteTable\"\n      ></PasteTable>\n\n      <!-- 页面排序 -->\n      <SortPage\n        :callback=\"insertValue\"\n        :belong_to_catalogs=\"belong_to_catalogs\"\n        :item_id=\"item_id\"\n        :page_id=\"page_id\"\n        :cat_id=\"cat_id\"\n        ref=\"SortPage\"\n      ></SortPage>\n      </el-container>\n    <Footer> </Footer>\n    <div class=\"\"></div>\n<!-- 模板存放的地方 -->\n<div id=\"api-doc-templ\"  ref=\"api_doc_templ\" style=\"display:none\">\n\n**简要描述：**\n\n- 用户注册接口\n\n**请求URL：**\n- ` http://xx.com/api/user/register `\n\n**请求方式：**\n- POST\n\n**参数：**\n\n|参数名|必选|类型|说明|\n|:----    |:---|:----- |-----   |\n|username |是  |string |用户名   |\n|password |是  |string | 密码    |\n|name     |否  |string | 昵称    |\n\n **返回示例**\n\n```\n  {\n    \"status\": 0,\n    \"data\": {\n      \"uid\": \"1\",\n      \"username\": \"12154545\",\n      \"name\": \"吴系挂\",\n      \"groupid\": 2 ,\n      \"reg_time\": \"1436864169\",\n      \"last_login_time\": \"0\",\n    }\n  }\n```\n\n **返回参数说明**\n\n|参数名|类型|说明|\n|:-----  |:-----|-----                           |\n|groupid |int   |用户组id，1：超级管理员；2：普通用户  |\n\n **备注**\n\n- 更多返回错误代码请看首页的错误代码描述\n\n</div>\n<div id=\"database-doc-templ\" ref=\"database_doc_templ\" style=\"display:none\">\n\n-  用户表，储存用户信息\n\n|字段|类型|空|默认|注释|\n|:----    |:-------    |:--- |-- -|------      |\n|uid    |int(10)     |否 |  |             |\n|username |varchar(20) |否 |    |   用户名  |\n|password |varchar(50) |否   |    |   密码    |\n|name     |varchar(15) |是   |    |    昵称     |\n|reg_time |int(11)     |否   | 0  |   注册时间  |\n\n- 备注：无\n\n</div>\n  </div>\n</template>\n\n<style scoped>\n  .container-narrow{\n    margin: 0 auto;\n    max-width: 90%;\n  }\n  .masthead{\n    width: 100%;\n    margin-top: 5px;\n  }\n  .cat{\n    width: 180px;\n  }\n  .num{\n    width: 60px;\n  }\n  .lang{\n    width: 120px;\n  }\n  .fun-btn-group{\n    margin-top: 15px;\n    margin-bottom: 15px;\n  }\n</style>\n\n<script>\nimport Editormd from '@/components/common/Editormd'\nimport JsonToTable from '@/components/common/JsonToTable'\nimport JsonBeautify from '@/components/common/JsonBeautify'\nimport TemplateList from '@/components/page/edit/TemplateList'\nimport HistoryVersion from '@/components/page/edit/HistoryVersion'\nimport AttachmentList from '@/components/page/edit/AttachmentList'\nimport PasteTable from '@/components/page/edit/PasteTable'\nimport SortPage from '@/components/page/edit/SortPage'\nimport { rederPageContent } from '@/models/page'\nimport {\n  apiTemplateZh,\n  databaseTemplateZh,\n  apiTemplateEn,\n  databaseTemplateEn\n} from '@/models/template'\n// var $s = require('scriptjs')\nvar $ = require('jquery')\n\nexport default {\n\n  data () {\n    return {\n      currentDate: new Date(),\n      itemList: {},\n      content: '',\n      title: '',\n      item_id: 0,\n      s_number: '',\n      page_id: '',\n      cid: '',\n      name: '',\n      cat_id: 0,\n      copy_page_id: '',\n      attachment_count: '',\n      catalogs: [],\n      isLock: 0,\n      intervalId: 0,\n      saving: false,\n      lang: '',\n      langs: []\n    }\n  },\n  computed: {\n    // 新建/编辑目录时供用户选择的上级目录列表\n    belong_to_catalogs: function () {\n      if (!this.catalogs || this.catalogs.length <= 0) {\n        return []\n      }\n      var Info = this.catalogs.slice(0)\n      var cat_array = []\n      // 这个函数将递归\n      var rename = function (catalog, p_cat_name) {\n        if (catalog.length > 0) {\n          for (var j = 0; j < catalog.length; j++) {\n            var cat_name = p_cat_name + ' / ' + catalog[j].cat_name\n            cat_array.push({\n              cat_id: catalog[j].cat_id,\n              cat_name: cat_name\n            })\n            if (catalog[j].sub && catalog[j].sub.length > 0) {\n              rename(catalog[j].sub, cat_name)\n            }\n          }\n        }\n      }\n      for (var i = 0; i < Info.length; i++) {\n        cat_array.push(Info[i])\n        if (Info[i].sub != null) {\n          rename(Info[i].sub, Info[i].cat_name)\n        }\n      }\n      var no_cat = { cat_id: 0, cat_name: this.$t('none') }\n      cat_array.push(no_cat)\n      return cat_array\n    }\n  },\n  components: {\n    Editormd,\n    JsonToTable,\n    JsonBeautify,\n    TemplateList,\n    AttachmentList,\n    PasteTable,\n    SortPage,\n    HistoryVersion\n  },\n  methods: {\n    get_lang () {\n      var that = this\n      var url = this.DocConfig.server + '/lang'\n      var params = new URLSearchParams()\n      that.$http.get(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            that.langs = response.data.data\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    // 获取页面内容\n    get_page_content (page_id) {\n      if (!page_id) {\n        page_id = this.page_id\n      }\n      var that = this\n      var url = this.DocConfig.server + '/admin/page'\n      var params = new URLSearchParams()\n      params.append('page_id', page_id)\n      that.$http.post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            // that.$message.success(\"加载成功\");\n            that.content = rederPageContent(response.data.data.pagecontent)\n            setTimeout(function () {\n              that.insertValue(that.content, 1)\n              document.body.scrollTop = document.documentElement.scrollTop = 0 // 回到顶部\n            }, 500)\n            setTimeout(function () {\n              // 如果长度大于3000,则关闭预览\n              if (that.content.length > 3000) {\n                that.editor_unwatch()\n              } else {\n                that.editor_watch()\n              }\n              that.draft()\n            }, 1000)\n            that.title = response.data.data.pagetitle\n            that.item_id = response.data.data.itemid\n            that.s_number = response.data.data.snumber\n            that.cid = response.data.data.cid\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    get_catalog (item_id, value) {\n      var that = this\n      var url = this.DocConfig.server + '/catListGroup'\n      var params = new URLSearchParams()\n      params.append('item_id', item_id)\n      params.append('cid', value)\n      console.log(value)\n      that.$http\n        .post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            var Info = response.data.data\n            that.catalogs = Info\n\n            that.get_default_cat()\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    },\n    // 获取默认该选中的目录\n    get_default_cat () {\n      var that = this\n      var url = this.DocConfig.server + '/getDefaultCat'\n      var params = new URLSearchParams()\n      params.append('page_id', this.$route.params.page_id)\n      params.append('item_id', that.$route.params.item_id)\n      params.append('copy_page_id', this.copy_page_id)\n      that.$http.post(url, params)\n        .then(function (response) {\n          if (response.data.status === 200) {\n            // that.$message.success(\"加载成功\")\n            var json = response.data.data\n            that.cat_id = json\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n    },\n    // 根据语言选择目录\n    selectCatalog () {\n      var that = this\n      that.get_catalog(this.$route.params.item_id, this.cid)\n    },\n    // 插入数据到编辑器中。插入到光标处。如果参数is_cover为真，则清空后再插入(即覆盖)。\n    insertValue (value, is_cover) {\n      if (value) {\n        const childRef = this.$refs.Editormd // 获取子组件\n        if (is_cover) {\n          // 清空\n          childRef.clear()\n        };\n        childRef.insertValue(value) // 调用子组件的方法\n      };\n    },\n    // 插入api模板\n    insert_api_template () {\n      var val\n      if (this.$cookies.get('lng') === 'ZH_CN') {\n        val = apiTemplateZh\n      } else {\n        val = apiTemplateEn\n      }\n      this.insertValue(val)\n    },\n    // 插入数据字典模板\n    insert_database_template () {\n      var val\n      if (this.$cookies.get('lng') === 'ZH_CN') {\n        val = databaseTemplateZh\n      } else {\n        val = databaseTemplateEn\n      }\n      this.insertValue(val)\n    },\n    editor_unwatch () {\n      const childRef = this.$refs.Editormd // 获取子组件\n      childRef.editor_unwatch()\n      if (sessionStorage.getItem('page_id_unwatch_' + this.page_id)) {\n      } else {\n        this.$message(this.$t('long_page_tips'))\n        sessionStorage.setItem('page_id_unwatch_' + this.page_id, 1)\n      }\n    },\n    editor_watch () {\n      const childRef = this.$refs.Editormd // 获取子组件\n      childRef.editor_watch()\n    },\n    // json转参数表格\n    ShowJsonToTable () {\n      const childRef = this.$refs.JsonToTable // 获取子组件\n      childRef.dialogFormVisible = true\n    },\n    // json格式化\n    ShowJsonBeautify () {\n      const childRef = this.$refs.JsonBeautify // 获取子组件\n      childRef.dialogFormVisible = true\n    },\n    ShowRunApi () {\n      window.open('http://runapi.doc.cc/')\n    },\n    // 更多模板、模板列表\n    ShowTemplateList () {\n      const childRef = this.$refs.TemplateList // 获取子组件\n      childRef.show()\n    },\n    ShowPasteTable () {\n      const childRef = this.$refs.PasteTable // 获取子组件\n      childRef.dialogFormVisible = true\n    },\n    // 展示历史版本\n    ShowHistoryVersion () {\n      const childRef = this.$refs.HistoryVersion // 获取子组件\n      childRef.show()\n    },\n    // 展示页面排序\n    ShowSortPage () {\n      this.save(() => {\n        const childRef = this.$refs.SortPage // 获取子组件\n        childRef.show()\n      })\n    },\n    save (callback) {\n      var that = this\n      if (this.saving) {\n        return false\n      }\n      this.saving = true\n      var loading = that.$loading()\n      const childRef = this.$refs.Editormd\n      var content = childRef.getMarkdown()\n      var cat_id = this.cat_id\n      var item_id = that.$route.params.item_id\n      var page_id = that.$route.params.page_id\n      var url = this.DocConfig.server + '/page/save'\n      var params = new URLSearchParams()\n      params.append('page_id', page_id)\n      params.append('item_id', item_id)\n      params.append('s_number', that.s_number)\n      params.append('page_title', that.title)\n      params.append('cat_id', cat_id)\n      params.append('cid', this.cid)\n      params.append('page_content', encodeURIComponent(content))\n      params.append('is_urlencode', 1)\n      that.$http.post(url, params)\n        .then(function (response) {\n          loading.close()\n          that.saving = false\n          if (response.data.status === 200) {\n            if (typeof callback === 'function') {\n              callback()\n            } else {\n              // that.$message.success(\"加载成功\")\n              // localStorage.removeItem('page_content')\n              // that.$router.push({ path: '/' + item_id, query: { page_id: response.data.data.page_id } })\n              that.$message({\n                showClose: true,\n                message: that.$t('save_success'),\n                type: 'success'\n              })\n            }\n            that.deleteDraft()\n            if (page_id <= 0) {\n              that.$router.push({\n                path: '/page/edit/' + item_id + '/' + response.data.data.ID\n              })\n              that.page_id = response.data.data.ID\n            }\n          } else {\n            that.$alert(response.data.message)\n          }\n        })\n      // 设置一个最长关闭时间\n      setTimeout(() => {\n        loading.close()\n        that.saving = false\n      }, 20000)\n    },\n    goback () {\n      var url = '/' + this.$route.params.item_id\n      this.$router.push({ path: url, query: { page_id: this.$route.params.page_id } })\n    },\n    dropdown_callback (data) {\n      if (data) {\n        data()\n      }\n    },\n    // 另存为模板\n    save_to_template () {\n      var that = this\n      const childRef = this.$refs.Editormd\n      var content = childRef.getMarkdown()\n      this.$prompt(that.$t('save_templ_title'), ' ', {\n      }).then(function (data) {\n        var url = this.DocConfig.server + '/template/save'\n        var params = new URLSearchParams()\n        params.append('template_title', data.value)\n        params.append('template_content', content)\n        that.$http.post(url, params)\n          .then(function (response) {\n            if (response.data.status === 200) {\n              that.$alert(that.$t('save_templ_text'))\n            } else {\n              that.$alert(response.data.message)\n            }\n          })\n      })\n    },\n    ShowAttachment () {\n      const childRef = this.$refs.AttachmentList // 获取子组件\n      childRef.show()\n    },\n    /** 粘贴上传图片 **/\n    on_paste () {\n      var that = this\n      var url = this.DocConfig.server + '/upload'\n      document.addEventListener('paste', function (e) {\n        var clipboard = e.clipboardData\n        for (var i = 0, len = clipboard.items.length; i < len; i++) {\n          if (clipboard.items[i].kind === 'file' || clipboard.items[i].type.indexOf('image') > -1) {\n            var imageFile = clipboard.items[i].getAsFile()\n            var form = new FormData()\n            form.append('t', 'ajax-uploadpic')\n            form.append('editormd-image-file', imageFile)\n            var loading = ''\n            var callback = function (type, data) {\n              type = type || 'before'\n              switch (type) {\n                // 开始上传\n                case 'before':\n                  loading = that.$loading()\n                  break\n                  // 服务器返回错误\n                case 'error':\n                  loading.close()\n                  that.$alert('图片上传失败')\n                  break\n                  // 上传成功\n                case 'success':\n                  loading.close()\n                  if (data.success === 1) {\n                    var value = '![](/' + data.url + ')'\n                    console.log(value)\n                    that.insertValue(value)\n                  } else {\n                    that.$alert('失败')\n                  }\n                  break\n              }\n              console.log(type)\n            }\n            $.ajax({\n              url: url,\n              type: 'POST',\n              dataType: 'json',\n              data: form,\n              processData: false,\n              contentType: false,\n              beforeSend: function () {\n                // eslint-disable-next-line standard/no-callback-literal\n                callback('before')\n              },\n              error: function () {\n                // eslint-disable-next-line standard/no-callback-literal\n                callback('error')\n              },\n              success: function (data) {\n                // eslint-disable-next-line standard/no-callback-literal\n                callback('success', data)\n              }\n            })\n            e.preventDefault()\n          }\n        }\n      })\n    },\n    // 草稿\n    draft () {\n      var that = this\n      var pkey = 'page_content_' + this.page_id\n      const childRef = this.$refs.Editormd\n      // 定时保存文本内容到localStorage\n      setInterval(() => {\n        var content = childRef.getMarkdown()\n        localStorage.setItem(pkey, content)\n      }, 30 * 1000)\n      // 检测是否有定时保存的内容\n      var page_content = localStorage.getItem(pkey)\n      if (\n        page_content &&\n        page_content.length > 0 &&\n        page_content !== childRef.getMarkdown() &&\n        childRef.getMarkdown() &&\n        childRef.getMarkdown().length > 10\n      ) {\n        localStorage.removeItem(pkey)\n        that\n          .$confirm(that.$t('draft_tips'), '', {\n            showClose: false\n          })\n          .then(() => {\n            that.insertValue(page_content, true)\n            localStorage.removeItem(pkey)\n          })\n          .catch(() => {\n            localStorage.removeItem(pkey)\n          })\n      }\n    },\n    // 遍历删除草稿\n    deleteDraft () {\n      for (var i = 0; i < localStorage.length; i++) {\n        var name = localStorage.key(i)\n        if (name.indexOf('page_content_') > -1) {\n          localStorage.removeItem(name)\n        }\n      }\n    },\n    // 锁定\n    async setLock () {\n      var url = this.DocConfig.server + '/page/setLock'\n      var formdata = new FormData()\n      formdata.append('page_id', this.page_id)\n      formdata.append('item_id', this.item_id)\n      if (this.page_id > 0) {\n        const { data: res } = await this.$http.post(url, formdata)\n        if (res.status === 200) {\n          this.isLock = 1\n        }\n      }\n    },\n    // 解除锁定\n    async unlock () {\n      if (!this.isLock) {\n        return // 本来处于未锁定中的话，不发起请求\n      }\n      var url = this.DocConfig.server + '/page/setLock'\n      var formdata = new FormData()\n      formdata.append('page_id', this.page_id)\n      formdata.append('item_id', this.item_id)\n      formdata.append('lock_to', 1000)\n      const { data: res } = await this.$http.post(url, formdata)\n      if (res.status === 200) {\n        this.isLock = 0\n      }\n    },\n    // 如果用户处于锁定状态的话，用心跳保持锁定\n    heartBeatLock () {\n      this.intervalId = setInterval(() => {\n        if (this.isLock) {\n          this.setLock()\n        }\n      }, 3 * 60 * 1000)\n    },\n    // 判断页面是否被锁定编辑\n    async remoteIsLock () {\n      var url = this.DocConfig.server + '/page/isLock'\n      var formdata = new FormData()\n      formdata.append('page_id', this.page_id)\n      const { data: res } = await this.$http.post(url, formdata)\n      // 判断已经锁定了不\n      if (res.data.lock > 0) {\n        if (res.data.isCurUser > 0) {\n          this.isLock = 1\n        } else {\n          this.$alert(this.$t('locking') + res.data.lockUsername)\n          this.goback()\n        }\n      } else {\n        this.setLock() // 如果没有被别人锁定，则进编辑页面后自己锁定。\n      }\n    },\n    // 由于页面关闭事件无法直接发起异步的ajax请求，所以用浏览器的navigator.sendBeacon来实现\n    unLockOnClose () {\n      let user_token = ''\n      const userinfostr = localStorage.getItem('userinfo')\n      if (userinfostr) {\n        const userinfo = JSON.parse(userinfostr)\n        if (userinfo && userinfo.user_token) {\n          user_token = userinfo.user_token\n        }\n      }\n      const analyticsData = new URLSearchParams({\n        page_id: this.page_id,\n        item_id: this.item_id,\n        lock_to: 1000,\n        user_token: user_token\n      })\n      const url = this.DocConfig.server + '/page/setLock'\n      if ('sendBeacon' in navigator) {\n        navigator.sendBeacon(url, analyticsData)\n      } else {\n        var client = new XMLHttpRequest()\n        client.open('POST', url, false)\n        client.send(analyticsData)\n      }\n    }\n  },\n  mounted () {\n    var that = this\n    this.item_id = this.$route.params.item_id\n    this.page_id = this.$route.params.page_id\n    this.copy_page_id = this.$route.query.copy_page_id ? this.$route.query.copy_page_id : ''\n    if (this.copy_page_id > 0) {\n      this.get_page_content(this.copy_page_id)\n    } else if (this.page_id > 0) {\n      this.get_page_content(this.page_id)\n    } else {\n      this.item_id = this.$route.params.item_id\n      this.content = this.$t('welcome_use_showdoc')\n    }\n    this.cid = this.itemList.cid\n    this.get_catalog(this.$route.params.item_id)\n    this.get_lang()\n    this.heartBeatLock()\n    this.remoteIsLock()\n    that.on_paste()\n    document.onkeydown = function (e) { // 对整个页面文档监听 其键盘快捷键\n      var keyNum = window.event ? e.keyCode : e.which // 获取被按下的键值\n      if (keyNum === 83 && e.ctrlKey) { // Ctrl +S 为保存\n        that.save()\n        e.preventDefault()\n      }\n    }\n    // document.addEventListener('paste', this.on_paste)\n    // window.addEventListener('beforeunload', this.unLockOnClose)\n  }\n  // beforeDestroy () {\n  //   // 解除对粘贴上传图片的监听\n  //   document.removeEventListener('paste', this.on_paste)\n  //   this.$message.closeAll()\n  //   clearInterval(this.intervalId)\n  //   this.unlock()\n  //   window.removeEventListener('beforeunload', this.unLockOnClose)\n  // }\n}\n</script>\n"]}]}