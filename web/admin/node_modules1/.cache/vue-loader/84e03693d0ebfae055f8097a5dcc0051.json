{"remainingRequest":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/AttachmentList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/src/components/page/edit/AttachmentList.vue","mtime":1622954869482},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jimmy_c/go/src/awesomeProject3/web/admin/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmaWxlaHViIGZyb20gJ0AvY29tcG9uZW50cy9wYWdlL2VkaXQvRmlsZWh1YicKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBjYWxsYmFjazoge30sCiAgICBwYWdlX2lkOiB7fSwKICAgIGl0ZW1faWQ6IHt9LAogICAgbWFuYWdlOiB7fQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50RGF0ZTogbmV3IERhdGUoKSwKICAgICAgY29udGVudDogW10sCiAgICAgIGRpYWxvZ1RhYmxlVmlzaWJsZTogZmFsc2UsCiAgICAgIHVwbG9hZFVybDogRG9jQ29uZmlnLnNlcnZlciArICcvYXBpL3BhZ2UvdXBsb2FkJwogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgZmlsZWh1YgogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHVwbG9hZERhdGE6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBwYWdlX2lkOiB0aGlzLnBhZ2VfaWQsCiAgICAgICAgaXRlbV9pZDogdGhpcy5pdGVtX2lkCiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldF9jb250ZW50ICgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgIHZhciB1cmwgPSBEb2NDb25maWcuc2VydmVyICsgJy9hcGkvcGFnZS91cGxvYWRMaXN0JwogICAgICB2YXIgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpCiAgICAgIHBhcmFtcy5hcHBlbmQoJ3BhZ2VfaWQnLCB0aGlzLnBhZ2VfaWQpCiAgICAgIHRoYXQuYXhpb3MucG9zdCh1cmwsIHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcl9jb2RlID09PSAwKSB7CiAgICAgICAgICB0aGF0LmRpYWxvZ1RhYmxlVmlzaWJsZSA9IHRydWUKICAgICAgICAgIC8vIHRoYXQuJG1lc3NhZ2Uuc3VjY2Vzcygi5Yqg6L295oiQ5YqfIik7CiAgICAgICAgICB0aGF0LmNvbnRlbnQgPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhhdC5kaWFsb2dUYWJsZVZpc2libGUgPSBmYWxzZQogICAgICAgICAgdGhhdC4kYWxlcnQocmVzcG9uc2UuZGF0YS5lcnJvcl9tZXNzYWdlKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBzaG93ICgpIHsKICAgICAgdGhpcy5nZXRfY29udGVudCgpCiAgICB9LAogICAgZG93bmxvYWRGaWxlIChyb3cpIHsKICAgICAgdmFyIHVybCA9IHJvdy51cmwKICAgICAgd2luZG93Lm9wZW4odXJsKQogICAgfSwKICAgIGRlbGV0ZUZpbGUgKHJvdykgewogICAgICB2YXIgdGhhdCA9IHRoaXMKICAgICAgdGhpcy4kY29uZmlybSh0aGF0LiR0KCdjb21maXJtX2RlbGV0ZScpLCAnICcsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhhdC4kdCgnY29uZmlybScpLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IHRoYXQuJHQoJ2NhbmNlbCcpLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB2YXIgZmlsZV9pZCA9IHJvdy5maWxlX2lkCiAgICAgICAgdmFyIHRoYXQgPSB0aGlzCiAgICAgICAgdmFyIHVybCA9IERvY0NvbmZpZy5zZXJ2ZXIgKyAnL2FwaS9wYWdlL2RlbGV0ZVVwbG9hZEZpbGUnCiAgICAgICAgdmFyIHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKQogICAgICAgIHBhcmFtcy5hcHBlbmQoJ2ZpbGVfaWQnLCBmaWxlX2lkKQogICAgICAgIHBhcmFtcy5hcHBlbmQoJ3BhZ2VfaWQnLCB0aGF0LnBhZ2VfaWQpCiAgICAgICAgdGhhdC5heGlvcy5wb3N0KHVybCwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3JfY29kZSA9PT0gMCkgewogICAgICAgICAgICB0aGF0LmdldF9jb250ZW50KCkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoYXQuJGFsZXJ0KHJlc3BvbnNlLmRhdGEuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIGNsZWFyRmlsZXMgKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMudXBsb2FkRmlsZSAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuY2xlYXJGaWxlcygpCiAgICAgIHRoaXMuZ2V0X2NvbnRlbnQoKQogICAgfSwKICAgIGluc2VydEZpbGUgKHJvdykgewogICAgICB2YXIgdmFsID0KICAgICAgICAnWycgKwogICAgICAgIHJvdy5kaXNwbGF5X25hbWUgKwogICAgICAgICddKCcgKwogICAgICAgIHJvdy51cmwgKwogICAgICAgICcgIlsnICsKICAgICAgICByb3cuZGlzcGxheV9uYW1lICsKICAgICAgICAnIiknCiAgICAgIHRoaXMuY2FsbGJhY2sodmFsKQogICAgICB0aGlzLmRpYWxvZ1RhYmxlVmlzaWJsZSA9IGZhbHNlCiAgICB9LAogICAgdXBsb2FkQ2FsbGJhY2sgKGRhdGEpIHsKICAgICAgaWYgKGRhdGEubWVzc2FnZSkgewogICAgICAgIHRoaXMuJGFsZXJ0KGRhdGEubWVzc2FnZSkKICAgICAgfQogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMudXBsb2FkRmlsZSAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuY2xlYXJGaWxlcygpCiAgICAgIHRoaXMuZ2V0X2NvbnRlbnQoKQogICAgfSwKICAgIC8vIOaWh+S7tuW6kwogICAgc2hvd0ZpbGVodWIgKCkgewogICAgICBjb25zdCBjaGlsZFJlZiA9IHRoaXMuJHJlZnMuZmlsZWh1YiAvLyDojrflj5blrZDnu4Tku7YKICAgICAgY2hpbGRSZWYuc2hvdygpCiAgICB9CiAgfSwKICBtb3VudGVkICgpIHt9Cn0K"},{"version":3,"sources":["AttachmentList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AttachmentList.vue","sourceRoot":"src/components/page/edit","sourcesContent":["<template>\n  <div class=\"hello\">\n    <Header></Header>\n\n    <el-container class=\"container-narrow\">\n      <el-dialog\n        :title=\"$t('attachment')\"\n        :visible.sync=\"dialogTableVisible\"\n        :close-on-click-modal=\"false\"\n      >\n        <el-form :inline=\"true\" class=\"demo-form-inline\">\n          <el-form-item>\n            <el-button @click=\"showFilehub\">{{$t('from_file_gub')}}</el-button>\n          </el-form-item>\n          <el-form-item>\n            <el-upload\n              class=\"upload-file\"\n              :action=\"uploadUrl\"\n              :on-success=\"uploadCallback\"\n              :on-error=\"uploadCallback\"\n              :data=\"uploadData\"\n              ref=\"uploadFile\"\n              v-if=\"manage\"\n            >\n              <el-button>{{$t('upload')}}</el-button>\n              <small>&nbsp;&nbsp;&nbsp;{{$t('file_size_tips')}}</small>\n            </el-upload>\n          </el-form-item>\n        </el-form>\n\n        <el-table :data=\"content\">\n          <el-table-column property=\"addtime\" :label=\"$t('add_time')\" width=\"170\"></el-table-column>\n          <el-table-column property=\"display_name\" :label=\"$t('file_name')\"></el-table-column>\n          <el-table-column :label=\"$t('operation')\" width=\"150\">\n            <template slot-scope=\"scope\">\n              <el-button\n                @click=\"downloadFile(scope.row)\"\n                type=\"text\"\n                size=\"small\"\n              >{{$t('download')}}</el-button>\n              <el-button\n                @click=\"insertFile(scope.row)\"\n                type=\"text\"\n                size=\"small\"\n                v-if=\"manage\"\n              >{{$t('insert')}}</el-button>\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                @click=\"deleteFile(scope.row)\"\n                v-if=\"manage\"\n              >{{$t('delete')}}</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-dialog>\n    </el-container>\n    <filehub :callback=\"get_content\" :item_id=\"item_id\" :page_id=\"page_id\" ref=\"filehub\"></filehub>\n    <Footer></Footer>\n    <div class></div>\n  </div>\n</template>\n\n<style>\n</style>\n\n<script>\nimport filehub from '@/components/page/edit/Filehub'\nexport default {\n  props: {\n    callback: {},\n    page_id: {},\n    item_id: {},\n    manage: {}\n  },\n  data () {\n    return {\n      currentDate: new Date(),\n      content: [],\n      dialogTableVisible: false,\n      uploadUrl: DocConfig.server + '/api/page/upload'\n    }\n  },\n  components: {\n    filehub\n  },\n  computed: {\n    uploadData: function () {\n      return {\n        page_id: this.page_id,\n        item_id: this.item_id\n      }\n    }\n  },\n  methods: {\n    get_content () {\n      var that = this\n      var url = DocConfig.server + '/api/page/uploadList'\n      var params = new URLSearchParams()\n      params.append('page_id', this.page_id)\n      that.axios.post(url, params).then(function (response) {\n        if (response.data.error_code === 0) {\n          that.dialogTableVisible = true\n          // that.$message.success(\"加载成功\");\n          that.content = response.data.data\n        } else {\n          that.dialogTableVisible = false\n          that.$alert(response.data.error_message)\n        }\n      })\n    },\n    show () {\n      this.get_content()\n    },\n    downloadFile (row) {\n      var url = row.url\n      window.open(url)\n    },\n    deleteFile (row) {\n      var that = this\n      this.$confirm(that.$t('comfirm_delete'), ' ', {\n        confirmButtonText: that.$t('confirm'),\n        cancelButtonText: that.$t('cancel'),\n        type: 'warning'\n      }).then(() => {\n        var file_id = row.file_id\n        var that = this\n        var url = DocConfig.server + '/api/page/deleteUploadFile'\n        var params = new URLSearchParams()\n        params.append('file_id', file_id)\n        params.append('page_id', that.page_id)\n        that.axios.post(url, params).then(function (response) {\n          if (response.data.error_code === 0) {\n            that.get_content()\n          } else {\n            that.$alert(response.data.error_message)\n          }\n        })\n      })\n    },\n    clearFiles () {\n      const childRef = this.$refs.uploadFile // 获取子组件\n      childRef.clearFiles()\n      this.get_content()\n    },\n    insertFile (row) {\n      var val =\n        '[' +\n        row.display_name +\n        '](' +\n        row.url +\n        ' \"[' +\n        row.display_name +\n        '\")'\n      this.callback(val)\n      this.dialogTableVisible = false\n    },\n    uploadCallback (data) {\n      if (data.message) {\n        this.$alert(data.message)\n      }\n      const childRef = this.$refs.uploadFile // 获取子组件\n      childRef.clearFiles()\n      this.get_content()\n    },\n    // 文件库\n    showFilehub () {\n      const childRef = this.$refs.filehub // 获取子组件\n      childRef.show()\n    }\n  },\n  mounted () {}\n}\n</script>\n"]}]}